<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="my">

	<!-- 유저 번호로 전체 리스트 가져오기 -->
	<select id="getUserList" resultType="com.javaex.vo.MyListVo"
		parameterType="int">
		<![CDATA[
			select r.user_no no,
				   r.no resNo,
				   r.status status,
                   p.name pName,
                   r.check_in checkIn,
                   r.check_out checkOut,
                   r.reg_date regDate
            from reservations r, pension p, rooms ro
			where r.room_no = ro.no
			and p.no = ro.pension_no
			and r.user_no = #{no}
			order by r.reg_date desc
		]]>
	</select>

	<!-- 유저 번호로 예약완료 리스트 가져오기 -->
	<select id="getReserveList" resultType="com.javaex.vo.MyListVo"
		parameterType="int">
		<![CDATA[
			select ot.status status,
					ot.pName pName,
					ot.checkIn checkIn,
					ot.checkOut checkOut
			from (select r.user_no no,
				   r.no resNo,
				   r.status status,
                   p.name pName,
                   r.check_in checkIn,
                   r.check_out checkOut,
                   r.reg_date regDate
            from reservations r, pension p, rooms ro
			where r.room_no = ro.no
			and p.no = ro.pension_no
			and r.user_no = #{no}
			order by r.reg_date desc) ot
			where status = '예약완료'
		
		]]>
	</select>

	<!-- 유저 번호로 이용완료 리스트 가져오기 -->
	<select id="getUsedList" resultType="com.javaex.vo.MyListVo"
		parameterType="int">
		<![CDATA[
			select ot.status status,
					ot.pName pName,
					ot.checkIn checkIn,
					ot.checkOut checkOut
			from (select r.user_no no,
				   r.no resNo,
				   r.status status,
                   p.name pName,
                   r.check_in checkIn,
                   r.check_out checkOut,
                   r.reg_date regDate
            from reservations r, pension p, rooms ro
			where r.room_no = ro.no
			and p.no = ro.pension_no
			and r.user_no = #{no}
			order by r.reg_date desc) ot
			where status = '이용완료'
		]]>
	</select>
	<!-- 유저 번호로 예약취소 리스트 가져오기 -->
	<select id="getCancelList" resultType="com.javaex.vo.MyListVo"
		parameterType="int">
		<![CDATA[
			select ot.status status,
					ot.pName pName,
					ot.checkIn checkIn,
					ot.checkOut checkOut
			from (select r.user_no no,
				   r.no resNo,
				   r.status status,
                   p.name pName,
                   r.check_in checkIn,
                   r.check_out checkOut,
                   r.reg_date regDate
            from reservations r, pension p, rooms ro
			where r.room_no = ro.no
			and p.no = ro.pension_no
			and r.user_no = #{no}
			order by r.reg_date desc) ot
			where status = '일반취소'
		]]>
	</select>
	<!-- 유저 번호로 양도대기 리스트 가져오기 -->
	<select id="getRelistList" resultType="com.javaex.vo.MyListVo"
		parameterType="int">
		<![CDATA[
			select ot.status status,
					ot.pName pName,
					ot.checkIn checkIn,
					ot.checkOut checkOut
			from (select r.user_no no,
				   r.no resNo,
				   r.status status,
                   p.name pName,
                   r.check_in checkIn,
                   r.check_out checkOut,
                   r.reg_date regDate
            from reservations r, pension p, rooms ro
			where r.room_no = ro.no
			and p.no = ro.pension_no
			and r.user_no = #{no}
			order by r.reg_date desc) ot
			where status = '양도대기'
		]]>
	</select>
	<!-- 유저 번호로 양도완료 리스트 가져오기 -->
	<select id="getTransferList" resultType="com.javaex.vo.MyListVo"
		parameterType="int">
		<![CDATA[
			select ot.status status,
					ot.pName pName,
					ot.checkIn checkIn,
					ot.checkOut checkOut
			from (select r.user_no no,
				   r.no resNo,
				   r.status status,
                   p.name pName,
                   r.check_in checkIn,
                   r.check_out checkOut,
                   r.reg_date regDate
            from reservations r, pension p, rooms ro
			where r.room_no = ro.no
			and p.no = ro.pension_no
			and r.user_no = #{no}
			order by r.reg_date desc) ot
			where status = '양도에의한취소'
		]]>
	</select>

</mapper>